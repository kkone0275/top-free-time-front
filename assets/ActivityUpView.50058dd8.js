import{Q as U,a as r}from"./QItem.b0361859.js";import{Q as T}from"./QSeparator.73eeb64f.js";import{Q as H,b as q,c as K,d as N,a as C,e as P}from"./QCheckbox.22976a8d.js";import{_ as $,a9 as S,r as E,aK as v,as as _,j as m,k as Q,l as i,G as f,z as w,A as o,d as a,F as h,au as I,ao as p,at as b,Q as g,X as V,p as D,s as G,t as L,aI as F}from"./index.27d8d230.js";import{Q as c}from"./QInput.2223e4aa.js";import{Q as Y}from"./QFile.f53f506e.js";import{Q as R}from"./QImg.c2dd4603.js";import{Q as X}from"./QCardSection.3c413c2c.js";import{Q as J}from"./QForm.ea4b6390.js";import{Q as O}from"./QCard.63dd59b2.js";import{Q as W}from"./QDialog.810b2af0.js";import{C as x}from"./ClosePopup.088c3a73.js";import"./use-dark.3da9499c.js";import"./QChip.31e89103.js";import"./QMenu.ee94a460.js";import"./selection.842a1c55.js";import"./focusout.f7bb970e.js";import"./focus-manager.387b0375.js";import"./format.3e32b8d9.js";import"./TouchPan.3b75ddb6.js";import"./uid.42677368.js";const Z=y=>(G("data-v-4de9787e"),y=y(),L(),y),ee=Z(()=>i("h5",{class:"text-center"},"\u63EA\u5718\u7BA1\u7406",-1)),le={style:{"max-width":"100%"}},ae={class:"q-pa-md q-gutter-md"},te=["src"],se={class:"q-pa-md"},oe={class:"row justify-center"},de={class:"col-12 col-md-1"},ie={class:"text-h6",align:"center"},re={class:"flex row justify-between",style:{padding:"16px 50px 16px 50px"}},ne={class:"row"},ue={class:"row items-center justify-end"},pe={class:"row items-center justify-end"},me={__name:"ActivityUpView",setup(y){const j=["\u53F0\u5317\u5E02","\u65B0\u5317\u5E02","\u65B0\u7AF9\u5E02","\u53F0\u4E2D\u5E02","\u96F2\u6797\u7E23","\u53F0\u4E2D\u5E02"],A=["\u904B\u52D5","\u804A\u5929","\u5403\u98EF","\u6563\u6B65","\u5531\u6B4C","\u6D3B\u52D5","\u9732\u71DF","\u65C5\u884C","\u95B1\u8B80"],u={required(t){return!!t||"\u6B04\u4F4D\u5FC5\u586B"},price(t){return t>=0||"\u50F9\u683C\u932F\u8AA4"}},d=S([]),z=E([]),e=S({_id:"",name:"",date:"",math:0,price:0,place:"",description:"",image:void 0,images:[],sell:!1,genre:"",category:"",valid:!1,loading:!1,dialog:!1,idx:-1}),B=t=>{t===-1?(e._id="",e.name="",e.date="",e.math=0,e.price=0,e.place="",e.description="",e.image=void 0,e.images=[],e.sell=!1,e.genre="",e.category="",e.valid=!1,e.loading=!1,e.idx=-1):(e._id=d[t]._id,e.name=d[t].name,e.date=d[t].date,e.math=d[t].math,e.price=d[t].price,e.place=d[t].place,e.description=d[t].description,e.image=d[t].image,e.images=d[t].images,e.sell=d[t].sell,e.genre=d[t].genre,e.category=d[t].category,e.valid=!1,e.loading=!1,e.idx=t),e.dialog=!0},M=async()=>{var s,l;e.loading=!0;const t=new FormData;t.append("name",e.name),t.append("math",e.math),t.append("price",e.price),t.append("place",e.place),t.append("date",e.date),t.append("description",e.description),t.append("sell",e.sell),t.append("image",e.image),t.append("genre",e.genre),t.append("category",e.category);for(const n of e.images)t.append("images",n);try{if(e._id.length===0){const{data:n}=await v.post("/products",t);d.push(n.result),_.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:n}=await v.patch("/products/"+e._id,t);d[e.idx]=n.result,_.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(n){_.fire({icon:"error",title:"\u5931\u6557",text:((l=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:l.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var t,s;try{const{data:l}=await v.get("/products/all");d.push(...l.result)}catch(l){_.fire({icon:"error",title:"\u5931\u6557",text:((s=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:s.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(t,s)=>(m(),Q(h,null,[ee,i("div",le,[i("div",ae,[f((m(),w(U,{clickable:"",class:"text-center"},{default:o(()=>[a(r,null,{default:o(()=>[p("\u5546\u54C1\u540D\u7A31")]),_:1}),a(r,null,{default:o(()=>[p("\u5546\u54C1\u50F9\u683C")]),_:1}),a(r,null,{default:o(()=>[p("\u5546\u54C1\u540D\u7A31")]),_:1}),a(r,null,{default:o(()=>[p("\u4E0A\u67B6\u72C0\u614B")]),_:1}),a(r,null,{default:o(()=>[p("\u5546\u54C1\u5206\u985E")]),_:1}),a(r,null,{default:o(()=>[p("\u7BA1\u7406/\u7DE8\u8F2F")]),_:1})]),_:1})),[[F]]),a(T),(m(!0),Q(h,null,I(d,(l,n)=>f((m(),w(U,{clickable:"",class:"text-center",style:{background:"#fff"},key:l._id},{default:o(()=>[a(r,null,{default:o(()=>[i("img",{src:l.image,"aspect-ratio":1,width:150,height:150,style:{"object-fit":"cover",margin:"auto"}},null,8,te)]),_:2},1024),a(r,null,{default:o(()=>[p(b(l.name),1)]),_:2},1024),a(r,null,{default:o(()=>[p(b(l.price)+" \u5143",1)]),_:2},1024),a(r,null,{default:o(()=>[a(H,{label:` ${l.sell?"\u6709":"\u672A"} \u4E0A\u67B6`,modelValue:l.sell,"onUpdate:modelValue":k=>l.sell=k,"checked-icon":"check",color:"green","unchecked-icon":"clear",style:{position:"absolute",left:"54%"}},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(r,null,{default:o(()=>[p(b(l.category),1)]),_:2},1024),a(r,null,{default:o(()=>[i("div",null,[a(g,{round:"",color:"secondary",size:"20px",icon:"save_as",onClick:k=>B(n)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)),[[F]])),128))])]),i("div",se,[i("div",oe,[i("div",de,[a(W,{modelValue:e.dialog,"onUpdate:modelValue":s[15]||(s[15]=l=>e.dialog=l),persistent:""},{default:o(()=>[a(O,{style:{"max-width":"800px"}},{default:o(()=>[i("div",ie,b(e._id.length>0?"\u7DE8\u8F2F\u63EA\u5718":"\u65B0\u589E\u63EA\u5718"),1),a(J,{onSubmit:M},{default:o(()=>[i("div",re,[a(c,{class:"col-12",style:{padding:"10px"},filled:"",modelValue:e.name,"onUpdate:modelValue":s[0]||(s[0]=l=>e.name=l),label:"\u6D3B\u52D5\u540D\u7A31","lazy-rules":"",rules:[u.required]},null,8,["modelValue","rules"]),a(c,{class:"col-12",style:{padding:"10px"},filled:"",modelValue:e.math,"onUpdate:modelValue":s[1]||(s[1]=l=>e.math=l),label:"\u53C3\u8207\u4EBA\u6578","lazy-rules":"",rules:[u.required,u.price]},null,8,["modelValue","rules"]),a(c,{class:"col-12",style:{padding:"10px"},filled:"",modelValue:e.price,"onUpdate:modelValue":s[2]||(s[2]=l=>e.price=l),label:"\u53C3\u8207\u8CBB\u7528","lazy-rules":"",rules:[u.required,u.price]},null,8,["modelValue","rules"]),a(c,{class:"col-12",filled:"",modelValue:e.place,"onUpdate:modelValue":s[3]||(s[3]=l=>e.place=l),label:"\u6D3B\u52D5\u5730\u9EDE","lazy-rules":"",rules:[u.required]},null,8,["modelValue","rules"]),a(c,{class:"col-12",style:{padding:"10px"},filled:"",modelValue:e.description,"onUpdate:modelValue":s[4]||(s[4]=l=>e.description=l),label:"\u5546\u54C1\u8AAA\u660E",clearable:"",type:"textarea",onKeydown:t.processTextareaFill,onFocus:t.processTextareaFill,rules:[u.required]},null,8,["modelValue","onKeydown","onFocus","rules"]),a(Y,{class:"col-12",filled:"","bottom-slots":"",modelValue:e.image,"onUpdate:modelValue":s[7]||(s[7]=l=>e.image=l),label:"\u6D3B\u52D5\u5716\u7247",counter:""},{prepend:o(()=>[a(V,{name:"cloud_upload",onClick:s[5]||(s[5]=D(()=>{},["stop","prevent"]))})]),append:o(()=>[a(V,{name:"close",onClick:s[6]||(s[6]=D(l=>t.model=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:o(()=>[p(" \u8ACB\u4E0A\u50B3.jpg\u6A94 ")]),_:1},8,["modelValue"]),a(Y,{class:"col-11",filled:"",modelValue:e.images,"onUpdate:modelValue":s[8]||(s[8]=l=>e.images=l),label:"\u8ACB\u9078\u64C7\u4E3B\u5716\u7247(\u53EF\u8907\u9078)","use-chips":"",multiple:""},{prepend:o(()=>[a(V,{name:"attach_file"})]),_:1},8,["modelValue"]),i("div",ne,[(m(!0),Q(h,null,I(z.value,l=>(m(),w(R,{class:"q-ml-lg",key:l,src:l,width:"100px"},null,8,["src"]))),128))]),a(X,{class:"col-12"},{default:o(()=>[a(c,{label:"\u63EA\u5718\u65E5\u671F\u3001\u6642\u9593",filled:"",modelValue:e.date,"onUpdate:modelValue":s[11]||(s[11]=l=>e.date=l),rules:[u.required]},{prepend:o(()=>[a(V,{name:"event",class:"cursor-pointer"},{default:o(()=>[a(q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(K,{modelValue:e.date,"onUpdate:modelValue":s[9]||(s[9]=l=>e.date=l),mask:"YYYY-MM-DD HH:mm"},{default:o(()=>[i("div",ue,[f(a(g,{label:"Close",color:"primary",flat:""},null,512),[[x]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:o(()=>[a(V,{name:"access_time",class:"cursor-pointer"},{default:o(()=>[a(q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(N,{modelValue:e.date,"onUpdate:modelValue":s[10]||(s[10]=l=>e.date=l),mask:"YYYY-MM-DD HH:mm",format24h:"","now-btn":""},{default:o(()=>[i("div",pe,[f(a(g,{label:"Close",color:"primary",flat:""},null,512),[[x]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"])]),_:1}),a(C,{class:"col-8",filled:"",options:j,modelValue:e.category,"onUpdate:modelValue":s[12]||(s[12]=l=>e.category=l),label:"\u6D3B\u52D5\u5730\u9EDE",rules:[u.required]},null,8,["modelValue","rules"]),a(C,{class:"col-8",filled:"",options:A,modelValue:e.genre,"onUpdate:modelValue":s[13]||(s[13]=l=>e.genre=l),label:"\u6D3B\u52D5\u985E\u578B",rules:[u.required]},null,8,["modelValue","rules"]),a(P,{class:"col-8",style:{"margin-bottom":"1.2rem"},modelValue:e.sell,"onUpdate:modelValue":s[14]||(s[14]=l=>e.sell=l),label:"\u4E0A\u67B6"},null,8,["modelValue"]),f(a(g,{class:"col-6",style:{padding:"10px"},flat:"",label:"Cancel",color:"primary",disabled:e.loading},null,8,["disabled"]),[[x]]),a(g,{class:"col-6",flat:"",label:"Add Send",type:"submit",disabled:e.loading,color:"primary"},null,8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])])],64))}};var je=$(me,[["__scopeId","data-v-4de9787e"]]);export{je as default};
