import{_ as H,r as S,c as K,a9 as A,aK as C,as as b,j as p,k as v,d as a,Q as c,l as i,F as Q,au as U,G as g,z as q,A as s,D as N,ao as u,at as k,X as V,p as D,s as P,t as E,aI as I}from"./index.2cc004d0.js";import{Q as Y,a as n}from"./QItem.48060d72.js";import{Q as L}from"./QSeparator.c879f8fa.js";import{Q as R,a as j,b as z,c as X,d as J,e as O}from"./QCheckbox.26169ed9.js";import{Q as f}from"./QInput.742a52eb.js";import{Q as B}from"./QFile.bff5e3bc.js";import{Q as W}from"./QImg.58d9b982.js";import{Q as Z}from"./QCardSection.e2eb4c79.js";import{Q as ee}from"./QForm.f66f2bc3.js";import{Q as le}from"./QCard.4251ae9b.js";import{Q as ae}from"./QDialog.6feaa591.js";import{C as x}from"./ClosePopup.4a944c31.js";import"./use-dark.e0944db6.js";import"./QChip.36f4582a.js";import"./QMenu.a2ad1da8.js";import"./selection.442b8b80.js";import"./focusout.524fa7f4.js";import"./focus-manager.387b0375.js";import"./format.3e32b8d9.js";import"./TouchPan.9d87becc.js";import"./uid.42677368.js";const te=_=>(P("data-v-3df3904d"),_=_(),E(),_),oe=te(()=>i("h5",{class:"text-center"},"\u63EA\u5718\u4E0A\u67B6",-1)),se={class:"q-pa-md q-gutter-sm col-12",align:"center"},re={style:{"max-width":"100%"}},de={class:"q-pa-md q-gutter-md"},ne=["src"],ie={class:"row justify-center"},ue={class:"text-h6",align:"center"},me={class:"flex row justify-between"},pe={class:"row"},ce={class:"row items-center justify-end"},fe={class:"row items-center justify-end"},ge={__name:"AddGang",setup(_){const y=["\u6240\u6709\u5730\u5340","\u53F0\u5317\u5E02","\u65B0\u5317\u5E02","\u6843\u5712\u5E02","\u81FA\u4E2D\u5E02","\u81FA\u5357\u5E02","\u9AD8\u96C4\u5E02"],M=["\u904B\u52D5","\u804A\u5929","\u5403\u98EF","\u6563\u6B65","\u5531\u6B4C","\u6D3B\u52D5","\u9732\u71DF","\u65C5\u884C","\u95B1\u8B80"],w=S(y[0]),T=K(()=>r.filter(t=>w.value===y[0]?t:t.category===w.value)),m={required(t){return!!t||"\u6B04\u4F4D\u5FC5\u586B"},price(t){return t>=0||"\u50F9\u683C\u932F\u8AA4"}},r=A([]),$=S([]),e=A({_id:"",name:"",date:"",math:0,price:0,place:"",description:"",image:void 0,images:[],sell:!1,genre:"",category:"",valid:!1,loading:!1,dialog:!1,idx:-1}),F=t=>{t===-1?(e._id="",e.name="",e.date="",e.math=0,e.price=0,e.place="",e.description="",e.image=void 0,e.images=[],e.genre="",e.category="",e.valid=!1,e.loading=!1,e.idx=-1):(e._id=r[t]._id,e.name=r[t].name,e.date=r[t].date,e.math=r[t].math,e.price=r[t].price,e.place=r[t].place,e.description=r[t].description,e.image=r[t].image,e.images=r[t].images,e.genre=r[t].genre,e.category=r[t].category,e.valid=!1,e.loading=!1,e.idx=t),e.dialog=!0},G=async()=>{var o,l;e.loading=!0;const t=new FormData;t.append("name",e.name),t.append("math",e.math),t.append("price",e.price),t.append("place",e.place),t.append("date",e.date),t.append("description",e.description),t.append("image",e.image),t.append("genre",e.genre),t.append("category",e.category);for(const d of e.images)t.append("images",d);try{if(e._id.length===0){const{data:d}=await C.post("/products",t);r.push(d.result),b.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:d}=await C.patch("/products/"+e._id,t);r[e.idx]=d.result,b.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(d){b.fire({icon:"error",title:"\u5931\u6557",text:((l=(o=d==null?void 0:d.response)==null?void 0:o.data)==null?void 0:l.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var t,o;try{const{data:l}=await C.get("/products/user");r.push(...l.result)}catch(l){b.fire({icon:"error",title:"\u5931\u6557",text:((o=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:o.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(t,o)=>(p(),v(Q,null,[oe,a(c,{class:"add",style:{background:"#FFB300",color:"white"},onClick:o[0]||(o[0]=l=>F(-1)),label:"\u65B0\u589E\u63EA\u5718"}),i("div",se,[(p(),v(Q,null,U(y,(l,d)=>a(c,{unelevated:"",rounded:"",color:"amber-7",key:d,label:l,onClick:h=>w.value=l},null,8,["label","onClick"])),64))]),i("div",re,[i("div",de,[g((p(),q(Y,{clickable:"",class:"text-center"},{default:s(()=>[a(n,null,{default:s(()=>[u("\u63EA\u5718\u5716\u7247")]),_:1}),a(n,null,{default:s(()=>[u("\u63EA\u5718\u540D\u7A31")]),_:1}),a(n,null,{default:s(()=>[u("\u53C3\u8207\u4EBA\u6578")]),_:1}),a(n,null,{default:s(()=>[u("\u4E0A\u67B6\u72C0\u614B")]),_:1}),a(n,null,{default:s(()=>[u("\u63EA\u5718\u5730\u5340")]),_:1}),a(n,null,{default:s(()=>[u("\u7BA1\u7406/\u7DE8\u8F2F")]),_:1})]),_:1})),[[I]]),a(L),(p(!0),v(Q,null,U(N(T),(l,d)=>g((p(),q(Y,{clickable:"",class:"text-center",style:{background:"#fff"},key:l._id},{default:s(()=>[a(n,null,{default:s(()=>[i("img",{src:l.image,"aspect-ratio":1,width:150,height:150,style:{"object-fit":"cover",margin:"auto"}},null,8,ne)]),_:2},1024),a(n,null,{default:s(()=>[u(k(l.name),1)]),_:2},1024),a(n,null,{default:s(()=>[u(k(l.math)+" \u4EBA",1)]),_:2},1024),a(n,null,{default:s(()=>[a(R,{label:` ${l.sell?"\u6709":"\u672A"} \u4E0A\u67B6`,modelValue:l.sell,"onUpdate:modelValue":h=>l.sell=h,"checked-icon":"check",color:"green","unchecked-icon":"clear",style:{position:"absolute",left:"54%"}},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(n,null,{default:s(()=>[u(k(l.category),1)]),_:2},1024),a(n,null,{default:s(()=>[i("div",null,[a(c,{round:"",color:"secondary",size:"20px",icon:"save_as",onClick:h=>F(d)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)),[[I]])),128))])]),i("div",ie,[a(ae,{modelValue:e.dialog,"onUpdate:modelValue":o[16]||(o[16]=l=>e.dialog=l),persistent:""},{default:s(()=>[a(le,{class:"sumbitcard"},{default:s(()=>[i("div",ue,k(e._id.length>0?"\u7DE8\u8F2F\u63EA\u5718":"\u65B0\u589E\u63EA\u5718"),1),a(ee,{onSubmit:G},{default:s(()=>[i("div",me,[a(f,{class:"col-12",filled:"",modelValue:e.name,"onUpdate:modelValue":o[1]||(o[1]=l=>e.name=l),label:"\u6D3B\u52D5\u540D\u7A31","lazy-rules":"",rules:[m.required]},null,8,["modelValue","rules"]),a(f,{class:"col-12",filled:"",modelValue:e.math,"onUpdate:modelValue":o[2]||(o[2]=l=>e.math=l),label:"\u53C3\u8207\u4EBA\u6578","lazy-rules":"",rules:[m.required,m.price]},null,8,["modelValue","rules"]),a(f,{class:"col-12",filled:"",modelValue:e.price,"onUpdate:modelValue":o[3]||(o[3]=l=>e.price=l),label:"\u53C3\u8207\u8CBB\u7528","lazy-rules":"",rules:[m.price]},null,8,["modelValue","rules"]),a(f,{class:"col-12",filled:"",modelValue:e.place,"onUpdate:modelValue":o[4]||(o[4]=l=>e.place=l),label:"\u6D3B\u52D5\u5730\u9EDE","lazy-rules":"",rules:[m.required]},null,8,["modelValue","rules"]),a(j,{class:"col-12",filled:"",options:M,modelValue:e.genre,"onUpdate:modelValue":o[5]||(o[5]=l=>e.genre=l),label:"\u6D3B\u52D5\u985E\u578B",rules:[m.required]},null,8,["modelValue","rules"]),a(f,{class:"col-12",filled:"",modelValue:e.description,"onUpdate:modelValue":o[6]||(o[6]=l=>e.description=l),label:"\u63EA\u5718\u6D3B\u52D5\u8AAA\u660E",clearable:"",type:"textarea",onKeydown:t.processTextareaFill,onFocus:t.processTextareaFill,rules:[m.required]},null,8,["modelValue","onKeydown","onFocus","rules"]),a(B,{class:"col-12",filled:"","bottom-slots":"",modelValue:e.image,"onUpdate:modelValue":o[9]||(o[9]=l=>e.image=l),label:"\u6D3B\u52D5\u5716\u7247",counter:""},{prepend:s(()=>[a(V,{name:"cloud_upload",onClick:o[7]||(o[7]=D(()=>{},["stop","prevent"]))})]),append:s(()=>[a(V,{name:"close",onClick:o[8]||(o[8]=D(l=>t.model=null,["stop","prevent"])),class:"cursor-pointer"})]),hint:s(()=>[u(" \u8ACB\u4E0A\u50B3.jpg\u6A94 ")]),_:1},8,["modelValue"]),a(B,{class:"col-12",filled:"",modelValue:e.images,"onUpdate:modelValue":o[10]||(o[10]=l=>e.images=l),label:"\u8ACB\u9078\u64C7\u4E3B\u5716\u7247(\u53EF\u8907\u9078)","use-chips":"",multiple:""},{prepend:s(()=>[a(V,{name:"attach_file"})]),_:1},8,["modelValue"]),i("div",pe,[(p(!0),v(Q,null,U($.value,l=>(p(),q(W,{class:"q-ml-lg",key:l,src:l,width:"100px"},null,8,["src"]))),128))]),a(Z,{class:"col-12"},{default:s(()=>[a(f,{label:"\u63EA\u5718\u65E5\u671F\u3001\u6642\u9593",filled:"",modelValue:e.date,"onUpdate:modelValue":o[13]||(o[13]=l=>e.date=l),rules:[m.required]},{prepend:s(()=>[a(V,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(z,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(X,{modelValue:e.date,"onUpdate:modelValue":o[11]||(o[11]=l=>e.date=l),mask:"YYYY-MM-DD HH:mm"},{default:s(()=>[i("div",ce,[g(a(c,{label:"Close",color:"primary",flat:""},null,512),[[x]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:s(()=>[a(V,{name:"access_time",class:"cursor-pointer"},{default:s(()=>[a(z,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(J,{modelValue:e.date,"onUpdate:modelValue":o[12]||(o[12]=l=>e.date=l),mask:"YYYY-MM-DD HH:mm",format24h:"","now-btn":""},{default:s(()=>[i("div",fe,[g(a(c,{label:"Close",color:"primary",flat:""},null,512),[[x]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"])]),_:1}),a(j,{class:"col-12 city",filled:"",options:y,modelValue:e.category,"onUpdate:modelValue":o[14]||(o[14]=l=>e.category=l),label:"\u6D3B\u52D5\u5730\u9EDE",rules:[m.required]},null,8,["modelValue","rules"]),a(O,{class:"col-8",style:{"margin-bottom":"1.2rem"},modelValue:e.sell,"onUpdate:modelValue":o[15]||(o[15]=l=>e.sell=l),label:"\u4E0A\u67B6"},null,8,["modelValue"]),g(a(c,{class:"col-6 Add-btn",flat:"",label:"Cancel",color:"primary"},null,512),[[x]]),a(c,{class:"col-6 Add-btn",flat:"",label:"Add Send",type:"submit",disabled:e.loading,color:"primary"},null,8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])],64))}};var Be=H(ge,[["__scopeId","data-v-3df3904d"]]);export{Be as default};
