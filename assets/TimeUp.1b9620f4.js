import{Q,a as d}from"./QItem.48060d72.js";import{Q as T}from"./QSeparator.c879f8fa.js";import{Q as Y,b as x,c as j,d as B,a as z,e as A}from"./QCheckbox.26169ed9.js";import{_ as H,a9 as w,aK as b,as as y,j as g,k,l as i,G as p,z as U,A as s,d as a,F as C,au as M,ao as n,at as m,Q as f,X as S,s as K,t as N,aI as q}from"./index.2cc004d0.js";import{Q as V}from"./QInput.742a52eb.js";import{Q as P}from"./QCardSection.e2eb4c79.js";import{Q as $}from"./QForm.f66f2bc3.js";import{Q as E}from"./QCard.4251ae9b.js";import{Q as G}from"./QDialog.6feaa591.js";import{C as h}from"./ClosePopup.4a944c31.js";import"./use-dark.e0944db6.js";import"./QChip.36f4582a.js";import"./QMenu.a2ad1da8.js";import"./selection.442b8b80.js";import"./focusout.524fa7f4.js";import"./focus-manager.387b0375.js";import"./format.3e32b8d9.js";import"./TouchPan.9d87becc.js";import"./uid.42677368.js";const L=_=>(K("data-v-9139463e"),_=_(),N(),_),R=L(()=>i("h5",{class:"text-center"},"\u7A7A\u9592\u7BA1\u7406",-1)),X={style:{"max-width":"100%"}},J={class:"q-pa-md q-gutter-md"},O={class:"q-pa-md"},W={class:"row justify-center"},Z={class:"col-12 col-md-1"},ee={class:"text-h6",align:"center"},le={class:"flex row justify-between"},ae={class:"row items-center justify-end"},te={class:"row items-center justify-end"},se={__name:"TimeUp",setup(_){const D=["\u53F0\u5317\u5E02","\u65B0\u5317\u5E02","\u65B0\u7AF9\u5E02","\u53F0\u4E2D\u5E02","\u96F2\u6797\u7E23","\u53F0\u4E2D\u5E02"],c={required(t){return!!t||"\u6B04\u4F4D\u5FC5\u586B"},price(t){return t>=0||"\u50F9\u683C\u932F\u8AA4"}},r=w([]),e=w({_id:"",name:"",date:"",hour:0,description:"",sell:!1,category:"",valid:!1,loading:!1,dialog:!1,idx:-1}),I=t=>{t===-1?(e._id="",e.name="",e.date="",e.hour=0,e.description="",e.sell=!1,e.category="",e.valid=!1,e.loading=!1,e.idx=-1):(e._id=r[t]._id,e.name=r[t].name,e.date=r[t].date,e.hour=r[t].hour,e.sell=r[t].sell,e.description=r[t].description,e.category=r[t].category,e.valid=!1,e.loading=!1,e.idx=t),e.dialog=!0},F=async()=>{var o,l;e.loading=!0;const t=new FormData;t.append("name",e.name),t.append("date",e.date),t.append("hour",e.hour),t.append("sell",e.sell),t.append("description",e.description),t.append("category",e.category);try{if(e._id.length===0){const{data:u}=await b.post("/times",t);r.push(u.result),y.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:u}=await b.patch("/times/"+e._id,t);r[e.idx]=u.result,y.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(u){y.fire({icon:"error",title:"\u5931\u6557",text:((l=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:l.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var t,o;try{const{data:l}=await b.get("/times/all");r.push(...l.result)}catch(l){y.fire({icon:"error",title:"\u5931\u6557",text:((o=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:o.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(t,o)=>(g(),k(C,null,[R,i("div",X,[i("div",J,[p((g(),U(Q,{clickable:"",class:"text-center"},{default:s(()=>[a(d,null,{default:s(()=>[n("\u500B\u4EBA\u66B1\u7A31")]),_:1}),a(d,null,{default:s(()=>[n("\u7A7A\u9592\u65E5\u671F")]),_:1}),a(d,null,{default:s(()=>[n("\u7A7A\u9592\u6642\u6578")]),_:1}),a(d,null,{default:s(()=>[n("\u4E0A\u67B6\u72C0\u614B")]),_:1}),a(d,null,{default:s(()=>[n("\u6D3B\u52D5\u5730\u5340")]),_:1}),a(d,null,{default:s(()=>[n("\u7BA1\u7406/\u7DE8\u8F2F")]),_:1})]),_:1})),[[q]]),a(T),(g(!0),k(C,null,M(r,(l,u)=>p((g(),U(Q,{clickable:"",class:"text-center",style:{background:"#fff"},key:l._id},{default:s(()=>[a(d,null,{default:s(()=>[n(m(l.name),1)]),_:2},1024),a(d,null,{default:s(()=>[n(m(l.date)+" \u958B\u59CB",1)]),_:2},1024),a(d,null,{default:s(()=>[n(m(l.hour)+" \u5C0F\u6642",1)]),_:2},1024),a(d,null,{default:s(()=>[a(Y,{label:` ${l.sell?"\u6709":"\u672A"} \u4E0A\u67B6`,modelValue:l.sell,"onUpdate:modelValue":v=>l.sell=v,"checked-icon":"check",color:"green","unchecked-icon":"clear",style:{position:"absolute",left:"54%"}},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(d,null,{default:s(()=>[n(m(l.category),1)]),_:2},1024),a(d,null,{default:s(()=>[i("div",null,[a(f,{round:"",color:"secondary",size:"20px",icon:"save_as",onClick:v=>I(u)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)),[[q]])),128))])]),i("div",O,[i("div",W,[i("div",Z,[a(G,{modelValue:e.dialog,"onUpdate:modelValue":o[8]||(o[8]=l=>e.dialog=l),persistent:""},{default:s(()=>[a(E,{style:{"max-width":"800px"}},{default:s(()=>[i("div",ee,m(e._id.length>0?"\u7DE8\u8F2F\u63EA\u5718":"\u65B0\u589E\u63EA\u5718"),1),a($,{onSubmit:F},{default:s(()=>[i("div",le,[a(V,{class:"col-12",style:{padding:"10px"},filled:"",modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=l=>e.name=l),label:"\u500B\u4EBA\u66B1\u7A31","lazy-rules":"",rules:[c.required]},null,8,["modelValue","rules"]),a(V,{class:"col-12",style:{padding:"10px"},filled:"",modelValue:e.description,"onUpdate:modelValue":o[1]||(o[1]=l=>e.description=l),label:"\u7A7A\u9592\u63CF\u8FF0",clearable:"",type:"textarea",onKeydown:t.processTextareaFill,onFocus:t.processTextareaFill,rules:[c.required]},null,8,["modelValue","onKeydown","onFocus","rules"]),a(P,{class:"col-12"},{default:s(()=>[a(V,{label:"\u6D3B\u52D5\u65E5\u671F\u3001\u6642\u9593",filled:"",modelValue:e.date,"onUpdate:modelValue":o[4]||(o[4]=l=>e.date=l),rules:[c.required]},{prepend:s(()=>[a(S,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(x,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(j,{modelValue:e.date,"onUpdate:modelValue":o[2]||(o[2]=l=>e.date=l),mask:"YYYY-MM-DD HH:mm"},{default:s(()=>[i("div",ae,[p(a(f,{label:"Close",color:"primary",flat:""},null,512),[[h]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:s(()=>[a(S,{name:"access_time",class:"cursor-pointer"},{default:s(()=>[a(x,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(B,{modelValue:e.date,"onUpdate:modelValue":o[3]||(o[3]=l=>e.date=l),mask:"YYYY-MM-DD HH:mm",format24h:"","now-btn":""},{default:s(()=>[i("div",te,[p(a(f,{label:"Close",color:"primary",flat:""},null,512),[[h]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"])]),_:1}),a(V,{class:"col-3",style:{padding:"10px"},filled:"",modelValue:e.hour,"onUpdate:modelValue":o[5]||(o[5]=l=>e.hour=l),label:"\u6D3B\u52D5\u5C0F\u6642\u6578","lazy-rules":"",rules:[c.required]},null,8,["modelValue","rules"]),a(z,{class:"col-9 city",filled:"",options:D,modelValue:e.category,"onUpdate:modelValue":o[6]||(o[6]=l=>e.category=l),label:"\u6D3B\u52D5\u5730\u9EDE",rules:[c.required]},null,8,["modelValue","rules"]),a(A,{class:"col-8",style:{"margin-bottom":"1.2rem"},modelValue:e.sell,"onUpdate:modelValue":o[7]||(o[7]=l=>e.sell=l),label:"\u4E0A\u67B6"},null,8,["modelValue"]),p(a(f,{class:"col-6",style:{padding:"10px"},flat:"",label:"Cancel",color:"primary",disabled:e.loading},null,8,["disabled"]),[[h]]),a(f,{class:"col-6",flat:"",label:"Add Send",type:"submit",disabled:e.loading,color:"primary"},null,8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])])],64))}};var we=H(se,[["__scopeId","data-v-9139463e"]]);export{we as default};
