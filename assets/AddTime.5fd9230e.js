import{_ as A,a9 as x,aK as b,as as _,j as y,k as w,d as a,Q as c,l as r,G as m,z as k,A as o,F as C,au as T,ao as u,at as g,X as U,s as Y,t as j,aI as S}from"./index.27d8d230.js";import{Q as q,a as i}from"./QItem.b0361859.js";import{Q as B,b as D,c as z,d as H,a as M,e as K}from"./QCheckbox.22976a8d.js";import{Q as V}from"./QInput.2223e4aa.js";import{Q as N}from"./QCardSection.3c413c2c.js";import{Q as P}from"./QForm.ea4b6390.js";import{Q as $}from"./QCard.63dd59b2.js";import{Q as E}from"./QDialog.810b2af0.js";import{C as v}from"./ClosePopup.088c3a73.js";import"./use-dark.3da9499c.js";import"./QChip.31e89103.js";import"./QMenu.ee94a460.js";import"./selection.842a1c55.js";import"./focusout.f7bb970e.js";import"./focus-manager.387b0375.js";import"./format.3e32b8d9.js";import"./TouchPan.3b75ddb6.js";import"./uid.42677368.js";const G=f=>(Y("data-v-76d2fe46"),f=f(),j(),f),L=G(()=>r("h5",{class:"text-center"},"\u7A7A\u9592\u767C\u5E03",-1)),R={style:{"max-width":"100%"}},X={class:"q-pa-md q-gutter-md top-item"},J={class:"q-pa-md"},O={class:"row justify-center"},W={class:"col-12 col-md-1"},Z={class:"text-h6",align:"center"},ee={class:"flex row justify-between"},le={class:"row items-center justify-end"},ae={class:"row items-center justify-end"},te={__name:"AddTime",setup(f){const F=["\u53F0\u5317\u5E02","\u65B0\u5317\u5E02","\u6843\u5712\u5E02","\u81FA\u4E2D\u5E02","\u81FA\u5357\u5E02","\u9AD8\u96C4\u5E02"],p={required(t){return!!t||"\u6B04\u4F4D\u5FC5\u586B"}},d=x([]),e=x({_id:"",name:"",date:"",hour:0,description:"",sell:!1,category:"",valid:!1,loading:!1,dialog:!1,idx:-1}),h=t=>{t===-1?(e._id="",e.name="",e.date="",e.hour=0,e.description="",e.sell=!1,e.category="",e.valid=!1,e.loading=!1,e.idx=-1):(e._id=d[t]._id,e.name=d[t].name,e.date=d[t].date,e.hour=d[t].hour,e.sell=d[t].sell,e.description=d[t].description,e.category=d[t].category,e.valid=!1,e.loading=!1,e.idx=t),e.dialog=!0},I=async()=>{var s,l;e.loading=!0;const t=new FormData;t.append("name",e.name),t.append("date",e.date),t.append("hour",e.hour),t.append("sell",e.sell),t.append("description",e.description),t.append("category",e.category);try{if(e._id.length===0){const{data:n}=await b.post("/times",t);d.push(n.result),_.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:n}=await b.patch("/times/"+e._id,t);d[e.idx]=n.result,_.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(n){_.fire({icon:"error",title:"\u5931\u6557",text:((l=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:l.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var t,s;try{const{data:l}=await b.get("/times/user");d.push(...l.result)}catch(l){_.fire({icon:"error",title:"\u5931\u6557",text:((s=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:s.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(t,s)=>(y(),w(C,null,[L,a(c,{class:"add",style:{background:"#F3A308",color:"white"},onClick:s[0]||(s[0]=l=>h(-1)),label:"\u65B0\u589E\u63EA\u5718"}),r("div",R,[r("div",X,[m((y(),k(q,{clickable:"",class:"text-center"},{default:o(()=>[a(i,null,{default:o(()=>[u("\u7A7A\u9592\u6642\u9593")]),_:1}),a(i,null,{default:o(()=>[u("\u500B\u4EBA\u66B1\u7A31")]),_:1}),a(i,null,{default:o(()=>[u("\u63EA\u5718\u5730\u5340")]),_:1}),a(i,null,{default:o(()=>[u("\u4E0A\u67B6\u72C0\u614B")]),_:1}),a(i,null,{default:o(()=>[u("\u7BA1\u7406/\u7DE8\u8F2F")]),_:1})]),_:1})),[[S]])]),(y(!0),w(C,null,T(d,(l,n)=>m((y(),k(q,{clickable:"",class:"text-center",style:{background:"#fff"},key:l._id},{default:o(()=>[a(i,null,{default:o(()=>[u(g(l.date),1)]),_:2},1024),a(i,null,{default:o(()=>[u(g(l.name),1)]),_:2},1024),a(i,null,{default:o(()=>[u(g(l.category),1)]),_:2},1024),a(i,null,{default:o(()=>[a(B,{label:` ${l.sell?"\u6709":"\u672A"} \u4E0A\u67B6`,modelValue:l.sell,"onUpdate:modelValue":Q=>l.sell=Q,"checked-icon":"check",color:"green","unchecked-icon":"clear",style:{position:"absolute",left:"66%"}},null,8,["label","modelValue","onUpdate:modelValue"])]),_:2},1024),a(i,null,{default:o(()=>[r("div",null,[a(c,{round:"",color:"secondary",size:"20px",icon:"save_as",onClick:Q=>h(n)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)),[[S]])),128))]),r("div",J,[r("div",O,[r("div",W,[a(E,{modelValue:e.dialog,"onUpdate:modelValue":s[9]||(s[9]=l=>e.dialog=l),persistent:""},{default:o(()=>[a($,{style:{"max-width":"800px"}},{default:o(()=>[r("div",Z,g(e._id.length>0?"\u7DE8\u8F2F\u586B\u7A7A":"\u65B0\u589E\u586B\u7A7A"),1),a(P,{onSubmit:I},{default:o(()=>[r("div",ee,[a(V,{class:"col-12",style:{padding:"10px"},filled:"",modelValue:e.name,"onUpdate:modelValue":s[1]||(s[1]=l=>e.name=l),label:"\u500B\u4EBA\u66B1\u7A31","lazy-rules":"",rules:[p.required]},null,8,["modelValue","rules"]),a(V,{class:"col-12",style:{padding:"10px"},filled:"",modelValue:e.description,"onUpdate:modelValue":s[2]||(s[2]=l=>e.description=l),label:"\u7A7A\u9592\u63CF\u8FF0",clearable:"",type:"textarea",onKeydown:t.processTextareaFill,onFocus:t.processTextareaFill,rules:[p.required]},null,8,["modelValue","onKeydown","onFocus","rules"]),a(N,{class:"col-12"},{default:o(()=>[a(V,{label:"\u6D3B\u52D5\u65E5\u671F\u3001\u6642\u9593",filled:"",modelValue:e.date,"onUpdate:modelValue":s[5]||(s[5]=l=>e.date=l),rules:[p.required]},{prepend:o(()=>[a(U,{name:"event",class:"cursor-pointer"},{default:o(()=>[a(D,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(z,{modelValue:e.date,"onUpdate:modelValue":s[3]||(s[3]=l=>e.date=l),mask:"YYYY-MM-DD HH:mm"},{default:o(()=>[r("div",le,[m(a(c,{label:"Close",color:"primary",flat:""},null,512),[[v]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),append:o(()=>[a(U,{name:"access_time",class:"cursor-pointer"},{default:o(()=>[a(D,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(H,{modelValue:e.date,"onUpdate:modelValue":s[4]||(s[4]=l=>e.date=l),mask:"YYYY-MM-DD HH:mm",format24h:"","now-btn":""},{default:o(()=>[r("div",ae,[m(a(c,{label:"Close",color:"primary",flat:""},null,512),[[v]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"])]),_:1}),a(V,{class:"col-3",style:{padding:"10px"},filled:"",modelValue:e.hour,"onUpdate:modelValue":s[6]||(s[6]=l=>e.hour=l),label:"\u6D3B\u52D5\u5C0F\u6642\u6578","lazy-rules":"",rules:[p.required]},null,8,["modelValue","rules"]),a(M,{class:"col-9 city",filled:"",options:F,modelValue:e.category,"onUpdate:modelValue":s[7]||(s[7]=l=>e.category=l),label:"\u6D3B\u52D5\u5730\u9EDE",rules:[p.required]},null,8,["modelValue","rules"]),a(K,{class:"col-8",style:{"margin-bottom":"1.2rem"},modelValue:e.sell,"onUpdate:modelValue":s[8]||(s[8]=l=>e.sell=l),label:"\u4E0A\u67B6"},null,8,["modelValue"]),m(a(c,{class:"col-6",style:{padding:"10px"},flat:"",label:"Cancel",color:"primary",disabled:e.loading},null,8,["disabled"]),[[v]]),a(c,{class:"col-6",flat:"",label:"Add Send",type:"submit",disabled:e.loading,color:"primary"},null,8,["disabled"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])])],64))}};var Qe=A(te,[["__scopeId","data-v-76d2fe46"]]);export{Qe as default};
